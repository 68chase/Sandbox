<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<link rel="stylesheet" href="css/colorpicker.css" type="text/css" />
    <link rel="stylesheet" media="screen" type="text/css" href="css/layout.css" />
    <title>Virtual World Framework</title>
	<script type="text/javascript" src="jquery-1.7.1.js"></script>
    <script type="text/javascript" src="jquery-ui-1.8.16.custom.js"></script>
	<style>
	.coldstate
	{
	
		
		background: #f6f8f9; /* Old browsers */
		background: -moz-linear-gradient(top,  #f6f8f9 0%, #e5ebee 50%, #d7dee3 56%, #f5f7f9 100%); /* FF3.6+ */
		background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#f6f8f9), color-stop(50%,#e5ebee), color-stop(56%,#d7dee3), color-stop(100%,#f5f7f9)); /* Chrome,Safari4+ */
		background: -webkit-linear-gradient(top,  #f6f8f9 0%,#e5ebee 50%,#d7dee3 56%,#f5f7f9 100%); /* Chrome10+,Safari5.1+ */
		background: -o-linear-gradient(top,  #f6f8f9 0%,#e5ebee 50%,#d7dee3 56%,#f5f7f9 100%); /* Opera 11.10+ */
		background: -ms-linear-gradient(top,  #f6f8f9 0%,#e5ebee 50%,#d7dee3 56%,#f5f7f9 100%); /* IE10+ */
		background: linear-gradient(to bottom,  #f6f8f9 0%,#e5ebee 50%,#d7dee3 56%,#f5f7f9 100%); /* W3C */
		filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#f6f8f9', endColorstr='#f5f7f9',GradientType=0 ); /* IE6-9 */

		border-radius: 10px;
		margin: 10px;
		padding: 10px;
		text-align: center;
		font-size: 1.8em;
		box-shadow: 5px 5px 10px;
		width: 200px;
		height: 200px;
		display: inline-block;
		vertical-align: middle;
		color: #52697E;
		overflow: hidden;
		text-decoration: none;
	}
	.hotstate
	{

		cursor: pointer;
		background: rgb(184,225,252); /* Old browsers */
		background: -moz-linear-gradient(top,  rgba(184,225,252,1) 0%, rgba(144,191,240,1) 47%, rgba(107,168,229,1) 53%, rgba(191,215,255,1) 100%); /* FF3.6+ */
		background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(184,225,252,1)), color-stop(47%,rgba(144,191,240,1)), color-stop(53%,rgba(107,168,229,1)), color-stop(100%,rgba(191,215,255,1))); /* Chrome,Safari4+ */
		background: -webkit-linear-gradient(top,  rgba(184,225,252,1) 0%,rgba(144,191,240,1) 47%,rgba(107,168,229,1) 53%,rgba(191,215,255,1) 100%); /* Chrome10+,Safari5.1+ */
		background: -o-linear-gradient(top,  rgba(184,225,252,1) 0%,rgba(144,191,240,1) 47%,rgba(107,168,229,1) 53%,rgba(191,215,255,1) 100%); /* Opera 11.10+ */
		background: -ms-linear-gradient(top,  rgba(184,225,252,1) 0%,rgba(144,191,240,1) 47%,rgba(107,168,229,1) 53%,rgba(191,215,255,1) 100%); /* IE10+ */
		background: linear-gradient(to bottom,  rgba(184,225,252,1) 0%,rgba(144,191,240,1) 47%,rgba(107,168,229,1) 53%,rgba(191,215,255,1) 100%); /* W3C */
		filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#b8e1fc', endColorstr='#bfd7ff',GradientType=0 ); /* IE6-9 */
		color: #52697E;
		border-radius: 10px;
		margin: 10px;
		padding: 10px;
		text-align: center;
		font-size: 1.8em;
		box-shadow: 5px 5px 10px;
		width: 200px;
		height: 200px;
		display: inline-block;
		vertical-align: middle;
		color: #52697E;
		overflow: hidden;
		text-decoration: none;
	}
	.title
	{
		margin-top: 1em;
		text-decoration: underline;
	}
	.description
	{
		font-size: .7em;
		margin-top: 1em;
	}
	.owner
	{
		font-size: .5em;
		color: gray;
		margin-top: 1em;
	}
	.objects
	{
		font-size: .5em;
		color: gray;
		margin-top: .2em;
	}
	.lastModified
	{
		font-size: .5em;
		color: gray;
		margin-top: .2em;
	}
	.stateid
	{
		font-size: .5em;
		color: lightgray;
		margin-top: .2em;
	}
	.button
	{

		cursor: pointer;
		background: rgb(226,226,226); /* Old browsers */
		background: -moz-linear-gradient(top,  rgba(226,226,226,1) 0%, rgba(219,219,219,1) 50%, rgba(209,209,209,1) 51%, rgba(254,254,254,1) 100%); /* FF3.6+ */
		background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(226,226,226,1)), color-stop(50%,rgba(219,219,219,1)), color-stop(51%,rgba(209,209,209,1)), color-stop(100%,rgba(254,254,254,1))); /* Chrome,Safari4+ */
		background: -webkit-linear-gradient(top,  rgba(226,226,226,1) 0%,rgba(219,219,219,1) 50%,rgba(209,209,209,1) 51%,rgba(254,254,254,1) 100%); /* Chrome10+,Safari5.1+ */
		background: -o-linear-gradient(top,  rgba(226,226,226,1) 0%,rgba(219,219,219,1) 50%,rgba(209,209,209,1) 51%,rgba(254,254,254,1) 100%); /* Opera 11.10+ */
		background: -ms-linear-gradient(top,  rgba(226,226,226,1) 0%,rgba(219,219,219,1) 50%,rgba(209,209,209,1) 51%,rgba(254,254,254,1) 100%); /* IE10+ */
		background: linear-gradient(to bottom,  rgba(226,226,226,1) 0%,rgba(219,219,219,1) 50%,rgba(209,209,209,1) 51%,rgba(254,254,254,1) 100%); /* W3C */
		filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#e2e2e2', endColorstr='#fefefe',GradientType=0 ); /* IE6-9 */
		border-radius: 10px;
		
		padding: 10px;
		text-align: center;
		font-size: 1.8em;
		box-shadow: 5px 5px 5px;
		
		width: 25%;
	}
	.hotstate:hover
	{
		border: 1px solid lightblue;
		width: 198px;
		height: 198px;
		color: #52697E;
	}
	.coldstate a
	{
		color: #52697E;
		
		text-decoration: none;
		cursor: pointer;
	}
	.hotstate a
	{
		color: #52697E;
		
		text-decoration: none;
		cursor: pointer;
	}
	.coldstate:hover
	{
		border: 1px solid lightblue;
		width: 198px;
		height: 198px;
		color: #52697E;
	}
	.input
	{
		font-size: 1.6em;
		padding: 5px;
		border-radius: 10px;
		width: 65%;
	
	}
	.editstate
	{
		text-align: right;
		background: lightgray;
		border-radius: 5px;
		position: absolute;
		display: block;
		margin-top: -9px;
		margin-left: 165px;
		height: 1em;
		line-height: 1em;
	}
	.editstatedata
	{
		display: inline-block;
		width: 25px;
		height: 15px;
		position: absolute;
		cursor: pointer;
		border-radius: 7px;
	}
	.editstatedelete
	{
		display: inline-block;
		
		height: 15px;
		position: absolute;
		cursor: pointer;
		border-radius: 7px;
		left: 25px;
	}
	.editstatedata img
	{
		height: 100%;
	}
	.editstatedata img:hover
	{
		background:red
		height: 200%;
	}
	.editstatedelete img
	{
		height: 100%;
	}
	</style>

    <script type="text/javascript">
		var g_Username;
		function showStates()
		{
			
			$.getJSON("./vwfDataManager.svc/states",function(e)
			{
				
				$('#activeInstances').empty();
				if(g_Username)
				{
					
					$('#activeInstances').append('<a href="createInstance.html" class="coldstate" id="newinstancebutton" ><img style="height: 204px;" src="icons/add.png"></a>');
				}
				
				var keys = Object.keys(e);
				for(var i = 0; i < keys.length; i++)
				{
					var id = keys[i].substr(13,16);
					if($('#'+id).length == 0)
					{
						
						$('#activeInstances').append('<div class="coldstate" id="'+id+'" ></div>');
						//$('#'+id).click(function(){
						//	var str = window.location.pathname;
						//	str = str.substr(0,str.lastIndexOf('/')+1)
						//	window.location.pathname = str + $(this).attr('id') + '/';
						//});
						
						$('#'+id).append('<div id="'+id+"edit"+'"class="editstate"></div>');
						
						$('#'+id+"edit").append('<a id="'+id+"editData"+'"class="editstatedata"><img src="icons/edit.jpg"></a>');
						$('#'+id+"edit").append('<a id="'+id+"editDelete"+'"class="editstatedelete"><img src="icons/delete.png"></a>');
						
						
						
						$('#'+id).append('<a  id="'+id+'data" ></a>');
						$('#'+id+'data').attr('href',id);
						$('#'+id+'editDelete').attr('href','deleteInstance.html?id='+id);
						$('#'+id+'editData').attr('href','editInstance.html?id='+id);
						
						$('#'+id+'data').append('<div class="title">'+e[keys[i]].title+'</div>');
						$('#'+id+'data').append('<div class="description">'+e[keys[i]].description+'</div>');
						$('#'+id+'data').append('<div class="owner">Owner: '+e[keys[i]].owner+'</div>');
						$('#'+id+'data').append('<div class="objects">Objects: '+e[keys[i]].objects+'</div>');
						$('#'+id+'data').append('<div class="lastModified">Last Modified: '+e[keys[i]].lastUpdate+'</div>');
						$('#'+id+'data').append('<div class="stateid">'+keys[i]+'</div>');
						
						if(g_Username != e[keys[i]].owner)
						{
							$('#'+id+"edit").hide();
						}
					}
				}
				
				$.getJSON("./admin/instances",function(e)
				{
					var keys = Object.keys(e);
					for(var i = 0; i < keys.length; i++)
					{
						var id = keys[i].substr(13,16);
						$('#'+id).attr("class", "hotstate");
					}
				});
			
			});
		}
		$(document).ready(function()
		{
			
			$.ajax('/vwfDataManager.svc/logindata',
				{
					cache:false,
					success:function(data,status,xhr)
					{
						data = JSON.parse(xhr.responseText);
						$('#username').text("Logged in as: " + data.username);
						g_Username = data.username;
						$('#login').hide();
						showStates();
						window.setInterval(function(){
							showStates();
						},5000);
					},
					error:function(xhr,status,err)
					{
						$('#username').hide();
						$('#logout').hide();
						$('#newstatearea').hide();
						
						showStates();
						window.setInterval(function(){
							showStates();
						},5000);
					}
					
			});
			
		});
	
	</script>
</head>
<body>
<div style="text-align: center">
	<div style="text-align: right; width:700px;display: inline-block;">
		<span href="" id="username">Name</span>
		<a href="login.html?return=index.html" id="login">Login</a>
		<a href="logout.html?return=index.html" id="logout">Logout</a>
		
	</div>
</div>	
    <div class="wrapper">
		<h1> Virtual World Framework Sandbox </h1>
		<div>Welcome to the Virtual World Framework Sandbox application. This landing page lists the worlds that currently exist. Worlds in green are currently active, while worlds in white are in "cold storage". Active worlds are worlds that currently have at least one client viewing them. You can click on any of the world names to launch that world. Or, you can choose "Make a new world" </div>
		
		
		<div id="activeInstances" style='width:800px'>
		
		</div>
		<div id="coldInstances" style='width:800px'>
		
		</div>
    </div>
</body>
</html>
