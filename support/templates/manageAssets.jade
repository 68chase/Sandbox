mixin manageAssets_head
	link(rel='stylesheet', href='vwf/view/editorview/css/assets.css')

mixin manageAssets_body

	#manageAssetsDialog(style='display: none;')

		#assetBrowser.verticalLayout(ng-controller='AssetListController')

			#controls.horizontalLayout
				label#hideThumbs.horizontalLayout
					input(type='checkbox', ng-model='hideThumbs')
					span Hide thumbnails

				input(type='search', ng-model='search', placeholder='Search')

			#assetList
				.asset.horizontalLayout(ng-class='{"selected-asset": fields.selected === asset.id}', ng-click='fields.selected = asset.id'
					ng-repeat='asset in assets | sortKeys:"name":true | filterThumbs:hideThumbs | searchFor:search', adl-scroll-to='fields.selected == asset.id')

					.info.verticalLayout
						p.name(ng-style='{"font-weight": asset._dirty ? "bold" : "normal"}') {{(asset._dirty ? '*' : '')+asset.name}}
						p.meta {{prettifyType(asset.type)}}, {{asset.size | humanSize}} ({{asset.id}})

					.nonbs-thumbnail(ng-if='!asset._basicDirty && asset.thumbnail'
						ng-style='{"background-image": "url("+appPath+"/assets/"+asset.id+"/meta/thumbnail)"}')

				.newAsset.horizontalLayout(ng-show='new._added', ng-class='{"selected-asset": fields.selected === "new"}'
					ng-click='fields.selected = "new"', adl-scroll-to='fields.selected == "new"')
					.info.verticalLayout
						p.name(ng-style='{"font-weight": new._dirty ? "bold" : "normal"}') {{(new._dirty ? '*' : '')+new.name}}
						p.meta {{prettifyType(new.type)}} (Unsaved)

			input#newAssetButton(type='button', value='+', ng-click='new._added = true; fields.selected = "new"')

		#propertyBrowser.verticalLayout(ng-controller='AssetPropertiesController')

			#dragarea.verticalLayout
				span.fixed-height {{!fields.selected ? '' : fields.selected==='new' ? 'Create Asset' : 'Replace Asset'}}
				p#filename.fixed-height(ng-show='fields.selected') {{selected.filename || 'Drag/drop or click to upload'}}
				#typeInput.horizontalLayout(ng-show='fields.selected && selected.filedata')
					input(type='text', placeholder='application/octet-stream', ng-model='selected.type')
					select(ng-model='selected.type', ng-options='prettifyType(v) for v in knownTypes')
						option(value='') */*

				input#fileInput(type='file', disabled='disabled', onchange='getFileData(this.files)')

			hr

			p#url.fixed-height {{getAssetUrl(fields.selected)}}
			label#name.verticalLayout Name
				br
				input(type='text', placeholder='Name', ng-model='selected.name', ng-change='selected._basicDirty = true', ng-disabled='!fields.selected')

			label#description.verticalLayout Description
				br
				textarea(placeholder='Description', ng-model='selected.description', ng-change='selected._basicDirty = true', ng-disabled='!fields.selected')

			label#thumbnail.horizontalLayout
				span Thumbnail asset id: 
				input(type='text', placeholder='1a2b3c4d', ng-model='selected._thumbnailId', ng-change='selected._basicDirty = true', ng-disabled='!fields.selected')

			hr

			#permissions.horizontalLayout

				label Permissions
					br
					input#group(type='text', placeholder='Group', ng-model='selected.group_name', ng-change='selected._groupDirty = true', ng-disabled='!fields.selected')

				table
					tr
						td
						td R
						td W
						td D

					- levels = ['User','Group','Other']
					- perms = ['Read','Write','Delete']
					each level in levels
						tr
							td= level
							each perm in perms

								- title = level +' '+ perm.toLowerCase()
								- model = 'selected.permissions.'+level+'.'+perm
								td
									input(type='checkbox', title=title, ng-model=model
										ng-change='selected._permsDirty = true', ng-disabled='!fields.selected')

			.spacer

			hr

			#buttons.horizontalLayout
				input(type='button', ng-click='saveData(selected.id)', ng-value='fields.selected === "new" ? "Upload" : "Save"'
					ng-disabled='!fields.selected || !selected._dirty')
				input(type='button', ng-click='fields.selected === "new" ? resetNew() : refreshData(selected.id)', value='Discard Changes'
					ng-disabled='(!fields.selected || !selected._dirty) && !selected._added')
				input(type='button', ng-click='deleteData(selected.id)' value='Delete'
					ng-disabled='!fields.selected || fields.selected === "new"')
